<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}CityBus Tracker{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet" />

  {% block styles %}
  <style>
  .breakdown-alert {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    text-align: center;
    padding: 10px;
    background-color: #ff6b6b;
    color: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
</style>
{% endblock %}
  {% block extra_css %}{% endblock %}
</head>

<body>
<div id="breakdown-alert" class="breakdown-alert" style="display: none;">
  <div class="alert alert-danger">
    <strong>üö® SERVICE DISRUPTION:</strong> 
    <span id="breakdown-message">Bus 101 is out of service near <span id="breakdown-location">Unknown</span>.</span>
  </div>
</div>
  <div class="page-wrapper">
    <!-- Header Section -->
    <header class="main-header" style="width: 100%;">
      <div class="header-content">
        <div class="header-title">
          <span class="header-icon">üöç</span>
          <span class="header-text">{% block header %}CityBus Tracker{% endblock %}</span>
        </div>
        <p class="tagline">
          {% block tagline %}Real-time bus tracking made simple{% endblock %}
        </p>
      </div>
    </header>

    <!-- Main Content -->
    {% block content %}{% endblock %}

    <!-- Footer -->
    <!-- <footer class="main-footer">
            <p>¬© 2025 CityBus Tracker | Real-time Public Transport Information </p>
        </footer> -->
  </div>

  {% block scripts %}
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
  // Initialize Firebase (use your existing config)
  const firebaseConfig = {
    databaseURL: "https://bus-tracking-system-37edd-default-rtdb.firebaseio.com/"
  };
  firebase.initializeApp(firebaseConfig);

  // Listen for breakdown updates
  firebase.database().ref('/breakdowns/101').on('value', (snapshot) => {
    const data = snapshot.val();
    const alertDiv = document.getElementById('breakdown-alert');
    
    if (data?.is_broken) {
  document.getElementById('breakdown-location').textContent = data.last_stop || 'Unknown';
  alertDiv.style.display = 'block';
  
  // Play alert sound (add this line)
  new Audio('https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3').play();
} else {
      alertDiv.style.display = 'none';
    }
  });
</script>
{% endblock %}

</body>

</html>